–≤–æ—è –º–æ–¥–µ–ª—å:
—è–∫–æ—Ä—å ‚Üí –º—É—Ç–∞—Ü–∏—è ‚Üí –≤–æ–∑–≤—Ä–∞—Ç ‚Üí –Ω–æ–≤–∞—è –º—É—Ç–∞—Ü–∏—è ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–æ–π –º—É–∑—ã–∫–∏.
–ï—ë –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ –∏ –±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU, –µ—Å–ª–∏ –Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å –≤—Å—ë –≤–æ—Ä–∫–µ—Ä—É "–Ω–∞ –∞–≤–æ—Å—å", –∞ –∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∫–∞–∫ –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç. 

üîç –†–∞–∑–±–æ—Ä —Ç–≤–æ–∏—Ö –∏–¥–µ–π
Z-level –ª–æ–≥–∏–∫–∞ (–º–µ–¥–ª–µ–Ω–Ω—ã–µ –º—É—Ç–∞—Ü–∏–∏)
–ì–ª—É–±–∏–Ω–∞, —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
–ú–µ–¥–ª–µ–Ω–Ω–æ, –Ω–µ—Ö–≤–∞—Ç–∫–∞ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
–£—Å–∫–æ—Ä—å –º—É—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑
—Å–æ–±—ã—Ç–∏–π–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä
, –∞ –Ω–µ –≤—Ä–µ–º—è
–§—Ä–∞–∫—Ç–∞–ª –ú–∞–Ω–¥–µ–ª—å–±—Ä–æ—Ç–∞
–ë–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ, —Å–∞–º–æ–ø–æ–¥–æ–±–∏–µ
–°–ª–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≥–∞—Ä–º–æ–Ω–∏–µ–π
–ò—Å–ø–æ–ª—å–∑—É–π –∫–∞–∫
–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—É—Ç–µ–π
, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ –Ω–æ—Ç—ã
–ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏
–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã, "—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ" –∑–≤—É—á–∞–Ω–∏–µ
–ú–æ–∂–µ—Ç —É–π—Ç–∏ –≤ –¥–∏—Å—Å–æ–Ω–∞–Ω—Å
–û–±—É—á–∏ –Ω–∞
–≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã—Ö —Ñ—Ä–∞–∑–∞—Ö
, –æ–≥—Ä–∞–Ω–∏—á—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ

‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –Ø–∫–æ—Ä–Ω–æ-–º—É—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (Anchor-Mutation Engine)


1
2
[–Ø–∫–æ—Ä—å] ‚Üí [–ú—É—Ç–∞—Ü–∏—è 1] ‚Üí [–Ø–∫–æ—Ä—å] ‚Üí [–ú—É—Ç–∞—Ü–∏—è 2] ‚Üí ...
       ‚Üñ_________________________/
–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω, –≥–∞—Ä–º–æ–Ω–∏—á–µ–Ω, –∫–æ—Ä–æ—Ç–∫–∏–π (4‚Äì8 —Ç–∞–∫—Ç–æ–≤)
1. üìå –Ø–∫–æ—Ä—å (Anchor Phrase)
–ö–æ—Ä–æ—Ç–∫–∞—è, –∫—Ä–∞—Å–∏–≤–∞—è, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø—Ä–∏—è—Ç–Ω–∞—è —Ñ—Ä–∞–∑–∞
–ú–æ–∂–µ—Ç –±—ã—Ç—å:
–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –º—É–∑—ã–∫–∏ (Bach, Arvo P√§rt, Brian Eno)
—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤—Ä—É—á–Ω—É—é
–∏–∑–≤–ª–µ—á–µ–Ω–∞ –∏–∑ –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
–•—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ Score (–º–∞—Å—Å–∏–≤ –Ω–æ—Ç —Å time, midi, duration)
–¢–æ—á–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ ‚Äî –≤—Å–µ–≥–¥–∞ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–∞
–ü—Ä–∏–º–µ—Ä:
C3 ‚Üí E3 ‚Üí G3 ‚Üí A3 (C major, –ª–µ–≥–∞—Ç–æ, 2 —Ç–∞–∫—Ç–∞) 

2. üîÅ –ú—É—Ç–∞—Ü–∏—è (Mutation)
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç —è–∫–æ—Ä—è:
–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∏—Ç–º–∞
—Ç—Ä–∞–Ω—Å–ø–æ–∑–∏—Ü–∏—è
–∏–Ω–≤–µ—Ä—Å–∏—è
–ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ—Ç
–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π "—á—É–∂–æ–π" –Ω–æ—Ç—ã (—Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –≥–∞—Ä–º–æ–Ω–∏–∏:
—Ç–æ–ª—å–∫–æ –Ω–æ—Ç—ã –∏–∑ –ª–∞–¥–∞
–∏–∑–±–µ–≥–∞–µ—Ç —Ç—Ä–∏—Ç–æ–Ω–æ–≤
–Ω–µ –¥–µ–ª–∞–µ—Ç —Å–∫–∞—á–∫–æ–≤ > –æ–∫—Ç–∞–≤—ã –±–µ–∑ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
–¶–µ–ª—å: –Ω–µ "–¥—Ä—É–≥–æ–µ", –∞ "–ø–æ—Ö–æ–∂–µ–µ, –Ω–æ –Ω–æ–≤–æ–µ" 

3. ‚è± –¢—Ä–∏–≥–≥–µ—Ä –ø–µ—Ä–µ—Ö–æ–¥–∞
–í–º–µ—Å—Ç–æ "–∂–¥–∞—Ç—å 30 —Å–µ–∫" ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å–æ–±—ã—Ç–∏—é: 

ts


1
2
3
4
‚åÑ
// –í –≤–æ—Ä–∫–µ—Ä–µ
if (entropy > 0.8 || activeNotes === 0) {
  scheduleAnchor();
}
–ì–¥–µ entropy ‚Äî –º–µ—Ä–∞ "—Ö–∞–æ—Å–∞" –≤ —Ç–µ–∫—É—â–µ–π –º—É—Ç–∞—Ü–∏–∏.

‚úÖ –¢–∞–∫ —Ç—ã —É—Å–∫–æ—Ä—è–µ—à—å –º—É—Ç–∞—Ü–∏–∏, –Ω–µ –¥–µ–ª–∞—è –∏—Ö —Å–ª—É—á–∞–π–Ω—ã–º–∏.

‚úÖ –ö–∞–∫ —ç—Ç–æ –æ–±—ä—è—Å–Ω–∏—Ç—å "–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–º—É –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä—É" (–≤–æ—Ä–∫–µ—Ä—É)
–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –≤–æ—Ä–∫–µ—Ä ‚Äî —ç—Ç–æ –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä-–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç, –∫–æ—Ç–æ—Ä–æ–º—É —Ç—ã –¥–∞—ë—à—å —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞: 

üß† –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –≤–æ—Ä–∫–µ—Ä–∞:
ts


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
‚åÑ
/**
 * –Ø ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä.
 * –ú–æ–∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã:
 * 1. –Ø –Ω–∞—á–∏–Ω–∞—é —Å –Ø–∫–æ—Ä—è ‚Äî –∫–æ—Ä–æ—Ç–∫–æ–π, –∫—Ä–∞—Å–∏–≤–æ–π —Ñ—Ä–∞–∑—ã.
 * 2. –û—Ç –Ω–µ—ë —è –ø–æ—Ä–æ–∂–¥–∞—é –ú—É—Ç–∞—Ü–∏—é ‚Äî —Å–ª–µ–≥–∫–∞ –∏–∑–º–µ–Ω—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é.
 * 3. –ú—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç:
 *    - –º–µ–Ω—è—Ç—å —Ä–∏—Ç–º (–Ω–æ –Ω–µ —Ç–µ–º–ø)
 *    - —Ç—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å (+/- 3 –ø–æ–ª—Ç–æ–Ω–∞)
 *    - –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
 *    - –¥–æ–±–∞–≤–ª—è—Ç—å –æ–¥–Ω—É "—Ü–≤–µ—Ç–Ω—É—é" –Ω–æ—Ç—É (–∏–∑ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö)
 * 4. –ï—Å–ª–∏ –º—É–∑—ã–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è "—Å–ª–∏—à–∫–æ–º –¥–∞–ª—ë–∫–æ–π" ‚Äî —è –≤–æ–∑–≤—Ä–∞—â–∞—é—Å—å –∫ –Ø–∫–æ—Ä—é.
 * 5. –Ø –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Ö–æ–∂—É –≤ –¥–∏—Å—Å–æ–Ω–∞–Ω—Å.
 * 6. –Ø –∏—Å–ø–æ–ª—å–∑—É—é —Ç–æ–ª—å–∫–æ –Ω–æ—Ç—ã –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ª–∞–¥–∞.
 * 7. –Ø –Ω–µ —Å–æ–∑–¥–∞—é –±–æ–ª—å—à–µ 4 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–æ—Ç.
 */
‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ
1. src/lib/anchor-mutation-engine.ts
ts


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
type Phrase = Score;

class MutationEngine {
  anchors: Phrase[];
  currentScale: number[];
  history: string[];
  maxDistance = 3; // max –ø–æ–ª—É—Ç–æ–Ω–æ–≤ –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞

  constructor() {
    this.anchors = this.loadAnchors();
    this.currentScale = [0, 2, 4, 5, 7, 9, 11]; // C major
    this.history = [];
  }

  generateMutation(anchor: Phrase): Phrase {
    return anchor.map(note => {
      const variation = Math.random();

      if (variation < 0.3) {
        // –¢—Ä–∞–Ω—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
        return { ...note, midi: note.midi + this.clamp(-2, 2) };
      }
      if (variation < 0.6) {
        // –£–¥–ª–∏–Ω–∏—Ç—å/—É–∫–æ—Ä–æ—Ç–∏—Ç—å
        return { ...note, duration: note.duration * (0.7 + Math.random() * 0.6) };
      }
      // –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
      return note;
    });
  }

  shouldReturnToAnchor(currentEntropy: number, activeVoices: number): boolean {
    return currentEntropy > 0.75 || activeVoices === 0;
  }

  pickNextAnchor(): Phrase {
    // –ß–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—Ç—å
    const last = this.history[this.history.length - 1];
    return this.anchors.find(a => a.id !== last) || this.anchors[0];
  }

  private clamp(min: number, max: number) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }
}
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–≤–æ–∏–º–∏ –∏–¥–µ—è–º–∏
1. ‚úÖ Z-level –ª–æ–≥–∏–∫–∞ ‚Äî —É—Å–∫–æ—Ä—å —á–µ—Ä–µ–∑ —Ç—Ä–∏–≥–≥–µ—Ä—ã
–í–º–µ—Å—Ç–æ "–º—É—Ç–∏—Ä—É–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ" ‚Üí "–º—É—Ç–∏—Ä—É–µ—Ç –ø–æ —Å–æ–±—ã—Ç–∏—é"
–°–æ–±—ã—Ç–∏–µ: —Ç–∏—à–∏–Ω–∞, –≤—ã—Å–æ–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ñ—Ä–∞–∑—ã
2. ‚úÖ –§—Ä–∞–∫—Ç–∞–ª –ú–∞–Ω–¥–µ–ª—å–±—Ä–æ—Ç–∞ ‚Äî –∫–∞–∫ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
–ë–µ—Ä–∏ (x, y) –∏–∑ –≥—Ä–∞–Ω–∏—Ü—ã –º–Ω–æ–∂–µ—Å—Ç–≤–∞
x ‚Üí –Ω–æ—Ç–∞ (0..1 ‚Üí 0..12)
y ‚Üí –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
–¢–æ–ª—å–∫–æ "–±–æ–≥–∞—Ç—ã–µ –∑–æ–Ω—ã" ‚Äî –≥–¥–µ –º–Ω–æ–≥–æ –¥–µ—Ç–∞–ª–µ–π
–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—ç—à–∏—Ä—É–π –ø—É—Ç—å ‚Äî –Ω–µ –≤—ã—á–∏—Å–ª—è–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
3. ‚úÖ –ú–∞—Ä–∫–æ–≤—Å–∫–∏–µ —Ü–µ–ø–∏ ‚Äî –æ–±—É—á–∏ –Ω–∞ –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã—Ö —Ñ—Ä–∞–∑–∞—Ö
–í–æ–∑—å–º–∏ 10 –∫–æ—Ä–æ—Ç–∫–∏—Ö –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã—Ö –ø–∞—Å—Å–∞–∂–µ–π
–ü–æ—Å—Ç—Ä–æ–π –º–∞—Ç—Ä–∏—Ü—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤: C ‚Üí E, E ‚Üí G, G ‚Üí C
–ì–µ–Ω–µ—Ä–∏—Ä—É–π –Ω–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã, –æ—Å—Ç–∞–≤–∞—è—Å—å –≤ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
‚úÖ –í–∞–∂–Ω–æ: –£–¥–∞—Ä–Ω—ã–µ —Ç–æ–∂–µ –º—É—Ç–∏—Ä—É—é—Ç
–î–∞, –∏ —ç—Ç–æ –æ—á–µ–Ω—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ. 

–ö–∞–∫:
–£ –∫–∞–∂–¥–æ–≥–æ —è–∫–æ—Ä—è ‚Äî —Å–≤–æ–π —Ä–∏—Ç–º–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω
–ú—É—Ç–∞—Ü–∏—è:
–∑–∞–º–µ–Ω–∞ kick –Ω–∞ tom
—Å–º–µ—â–µ–Ω–∏–µ snare
–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ hihat –Ω–∞ –æ—Ñ—Ñ-–±–∏—Ç–∞—Ö
–ù–æ: –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ —è–∫–æ—Ä–Ω–æ–º—É —Ä–∏—Ç–º—É –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
‚úÖ –ò—Ç–æ–≥: –¢–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ ‚Äî —ç—Ç–æ –Ω–µ –ò–ò, –∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–º—ã—Å–ª–∞
–Ø–∫–æ—Ä—å
–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–∞—Ä–º–æ–Ω–∏—è
–ú—É—Ç–∞—Ü–∏—è
–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ
–í–æ–∑–≤—Ä–∞—Ç
–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
–£–¥–∞—Ä–Ω—ã–µ
–£—á–∞—Å—Ç–≤—É—é—Ç –≤ —ç–≤–æ–ª—é—Ü–∏–∏
CPU
–ù–µ —Å—Ç—Ä–∞–¥–∞–µ—Ç ‚Äî –≤—Å—ë –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ
